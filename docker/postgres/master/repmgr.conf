# repmgr.conf - Master Configuration

# Basic settings
node_id=1
node_name='postgres-master'
conninfo='host=postgres-master user=repmgr dbname=repmgr connect_timeout=2'
data_directory='/var/lib/postgresql/data'

# Replication settings
replication_user='repmgr'
replication_type='physical'

# Failover settings
failover='automatic'
promote_command='/usr/lib/postgresql/15/bin/repmgr standby promote -f /etc/repmgr.conf --log-to-file'
follow_command='/usr/lib/postgresql/15/bin/repmgr standby follow -f /etc/repmgr.conf --log-to-file --upstream-node-id=%n'

# Monitoring
monitor_interval_secs=5
monitoring_history=yes
connection_check_type='ping'

# Logging
log_level='INFO'
log_facility='STDERR'
log_file='/var/log/repmgr/repmgr.log'
log_status_interval=300

# Service control
service_start_command='pg_ctl -D /var/lib/postgresql/data -l /var/lib/postgresql/data/startup.log start'
service_stop_command='pg_ctl -D /var/lib/postgresql/data stop -m fast'
service_restart_command='pg_ctl -D /var/lib/postgresql/data restart -m fast'
service_reload_command='pg_ctl -D /var/lib/postgresql/data reload'

# SSH settings for witness server (if needed)
ssh_options='-q -o ConnectTimeout=10'

# Node priority (higher number = higher priority for promotion)
priority=100